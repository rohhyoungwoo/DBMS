-- 집계함수 : 결과 행 1개
-- 주의 사항 : NULL은 포함시키지 않는다

SELECT * FROM employees;

-- count()
-- 전체 직원 수 확인
SELECT COUNT(*)
FROM EMPLOYEES;

-- 특정 부서 101번의 직원 수 확인
SELECT DISTINCT DEPARTMENT_ID
FROM EMPLOYEES;

SELECT COUNT(*) AS "110번의 직원수"
FROM EMPLOYEES
WHERE DEPARTMENT_ID = 110;

-- SUM()
-- 모든 직원의 급여 총합 계산
SELECT SUM(SALARY)
FROM EMPLOYEES;

-- 부서별 급여 총합 계산
SELECT DEPARTMENT_ID, SALARY 
FROM EMPLOYEES;

SELECT DEPARTMENT_ID, SUM(SALARY)
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID;

-- AVG()
-- 전체 직원의 평균 급여
SELECT AVG(SALARY)
FROM EMPLOYEES;

-- 부서별 평균 급여
SELECT DEPARTMENT_ID, AVG(SALARY)
FROM EMPLOYEES 
GROUP BY DEPARTMENT_ID;

-- MAX(), MIN()
SELECT MAX(SALARY), MIN(SALARY)
FROM EMPLOYEES;

-- 부서별 최고급여, 최저급여, 평균급여, 총합 조회하기
SELECT 	DEPARTMENT_ID, MAX(SALARY), MIN(SALARY), AVG(SALARY), SUM(SALARY)
FROM EMPLOYEES
GROUP  BY DEPARTMENT_ID;

SELECT *
FROM EMPLOYEES;

SELECT COUNT(NVL(COMMISSION_PCT,0)), COUNT(COMMISSION_PCT)
FROM EMPLOYEES;

-- GROUP BY, HAVING
--  평균 급여가 5000이상인 부서 조회
SELECT DEPARTMENT_ID, AVG(SALARY)
FROM EMPLOYEES
--WHERE SALARY >= 5000
GROUP BY DEPARTMENT_ID;

SELECT DEPARTMENT_ID, AVG(SALARY)
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID
HAVING AVG(SALARY) >= 5000;

-- 부서별 급여 총합이 30000보다 작은 부서들만 내림차순으로 정렬
SELECT DEPARTMENT_ID, SUM(SALARY) AS "급여 총합"
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID
HAVING SUM(SALARY) < 50000
ORDER BY "급여 총합" DESC;

-- GROUP BY : ~별
-- GROUP BY 컬럼명 HAVING 조건식
-- WHERE절은 집계함수 불가, HAVING 집계함수 가능


